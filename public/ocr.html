<!-- ============================================================
     public/ocr.html
     OCR Row Debugger + Global Rules editor + Run Scopes + Issues panel (split view)
     ============================================================ -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>OCR Row Debugger</title>
  <link rel="stylesheet" href="/ocr.css">
</head>
<body>
  <h1>OCR Row Debugger</h1>

  <div id="mainLayout">
    <!-- LEFT: existing controls/debugger -->
    <div id="leftPane">
      <div class="controls">
        <label>Animal / Table:</label>
        <select id="tableSelect"></select>

        <label>Pause (ms):</label>
        <input id="pauseMs" type="number" value="2500" min="0" step="250" />

        <button id="startBtn">Start (Debugger)</button>
        <button id="stopBtn">Stop (Debugger)</button>
      </div>

      <div class="controls" style="margin-top:8px;">
        <label><b>Run OCR (Scopes):</b></label>

        <label>Scope:</label>
        <select id="runScope">
          <option value="row">One row</option>
          <option value="file">One file</option>
          <option value="animal">One animal</option>
          <option value="all">All animals</option>
        </select>

        <label>File:</label>
        <select id="runFile"></select>

        <label>Row:</label>
        <input id="runRowIndex" type="number" value="0" min="0" step="1" style="width:80px;" />

        <button id="runStartBtn">Start Run</button>
        <button id="runStopBtn">Stop Run</button>

        <span id="runStatus" style="margin-left:8px;"></span>
      </div>

      <section class="meta">
        <div><b>Global OCR Rules (saved to /ocrRules.json)</b></div>

        <div class="hint">
          <b>Format restrictions:</b>
          <ul>
            <li><code>n</code> = digit slot</li>
            <li>Options only inside parentheses: <code>(n|nn)</code></li>
            <li>Ranges only inside parentheses: <code>(n..nnn)</code> means n OR nn OR nnn</li>
            <li>Outside parentheses, <code>|</code> and <code>..</code> are literal characters</li>
            <li>One format per line; if any line matches, the value is accepted</li>
          </ul>
          <b>Enum restrictions (STRICT):</b> one allowed value per line.
        </div>

        <div id="globalRules">(loading rules...)</div>

        <div style="margin-top:10px;">
          <button id="saveGlobalRulesBtn">Save Global Rules</button>
          <span id="globalRulesStatus"></span>
        </div>
      </section>

      <div class="meta">
        <div><b>PNG:</b> <span id="fileName">(unknown)</span></div>
        <div><b>Row:</b> <span id="rowNum">-</span></div>
        <div><b>Status:</b> <span id="status">(idle)</span></div>
      </div>

      <div id="rowView"></div>
    </div>

    <!-- RIGHT: issues panel -->
    <div id="rightPane" class="meta">
      <div><b>Issues (live)</b></div>
      <div class="hint" style="margin-top:6px;">
        Resolve blocking date issues first so OCR can resume scanning that file.
      </div>
      <div id="issuesBox">(loading...)</div>
    </div>
  </div>

  <script type="module" src="/ocr.js"></script>
</body>
</html>